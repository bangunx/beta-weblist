<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📹 Peta CCTV Kota Malang</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'malang-indigo': '#667eea',
                        'malang-purple': '#764ba2'
                    }
                }
            }
        };
    </script>

    <!-- Leaflet styles -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">

    <!-- App styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loading" class="loading flex flex-col items-center gap-4" role="status" aria-live="polite">
        <h2>📡 Menyiapkan peta CCTV...</h2>
        <div class="spinner" aria-hidden="true"></div>
        <p>Mohon tunggu sebentar.</p>
    </div>

    <header class="header shadow-2xl ring-1 ring-white/40" role="banner">
        <h1>📹 Peta CCTV Kota Malang</h1>
        <p>Gunakan pencarian atau filter untuk menemukan kamera CCTV yang Anda butuhkan</p>
    </header>

    <aside class="controls space-y-3 text-sm sm:text-base" aria-label="Kontrol peta CCTV">
        <div class="search-box">
            <input type="search"
                   class="search-input"
                   placeholder="Cari nama kamera, lokasi, atau kecamatan..."
                   aria-label="Cari CCTV"
                   autocomplete="off">
            <div class="search-results" role="listbox" aria-label="Hasil pencarian CCTV"></div>
        </div>

        <div class="filter-group" role="group" aria-label="Filter status kamera">
            <button type="button" class="filter-btn btn-all active" data-filter="all">📹 Semua</button>
            <button type="button" class="filter-btn btn-online" data-filter="online">🟢 Online</button>
            <button type="button" class="filter-btn btn-offline" data-filter="offline">🔴 Offline</button>
            <button type="button" class="filter-btn btn-intersection" data-filter="intersection">🚦 Persimpangan</button>
            <button type="button" class="filter-btn btn-street" data-filter="street">🛣️ Jalan</button>
        </div>

        <div class="district-filter">
            <label for="district-filter" class="district-label">📍 Kecamatan</label>
            <select id="district-filter" class="district-select" aria-label="Filter kecamatan">
                <option value="all">Semua kecamatan</option>
            </select>
        </div>
    </aside>

    <aside class="stats shadow-2xl ring-1 ring-white/40" id="stats" aria-label="Statistik kamera CCTV">
        <h3>📊 Statistik</h3>
        <div class="stat-item">
            <span class="stat-label">Total CCTV:</span>
            <span class="stat-value" id="total-cctv">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">🟢 Online:</span>
            <span class="stat-value" id="online-cctv">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">🔴 Offline:</span>
            <span class="stat-value" id="offline-cctv">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">🚦 Persimpangan:</span>
            <span class="stat-value" id="intersection-cctv">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">🛣️ Jalan:</span>
            <span class="stat-value" id="street-cctv">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">🏙️ Kecamatan:</span>
            <span class="stat-value" id="district-count">0</span>
        </div>
        <div class="stat-meta">
            <span class="stat-label">⏱️ Diperbarui:</span>
            <span class="stat-value" id="data-updated">-</span>
        </div>
    </aside>

    <main id="map" role="application" aria-label="Peta interaktif CCTV Kota Malang"></main>

    <div id="cctv-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title" id="modal-title">Detail CCTV</span>
                <button type="button" class="close" aria-label="Tutup detail">&times;</button>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

    <!-- Leaflet scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" defer></script>
    <!-- HLS playback -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.12/dist/hls.min.js" defer></script>

    <!-- Application scripts -->
    <script src="js/utils.js" defer></script>
    <script src="js/data.js" defer></script>
    <script src="js/data-manager.js" defer></script>
    <script src="js/ui.js" defer></script>
    <script src="js/map.js" defer></script>
    <script src="js/performance.js" defer></script>
    <script src="js/keyboard.js" defer></script>
    <script src="js/app.js" defer></script>
</body>
</html>
